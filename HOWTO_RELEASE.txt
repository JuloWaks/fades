Steps before a release is done
------------------------------

Check all is crispy

  rm -rf build dist
  ./setup.py clean build
  ./setup.py clean sdist


Edit the ``fades/_version.py`` file properly, then tag and commit/push

  git tag release-VERSION
  git commit -am "Release VERSION"
  git push --tag


How to release it to PyPI
-------------------------

Dead simple:

  rm -rf build dist
  ./setup.py clean sdist
  fades -d twine -x twine upload dist/fades-*


How to create a .deb
--------------------

Create the tarball:

  rm -rf build dist
  ./setup.py clean sdist


Copy this tarball to a clean dir, renaming as "orig"

  mkdir /tmp/fades_pack
  cp dist/fades-X.Y.tar.gz /tmp/fades_pack/fades_X.Y.orig.tar.gz
  cd /tmp/fades_pack


Most of next instructions come from http://wiki.debian.org/Python/GitPackaging

  tar -xf fades_X.Y.orig.tar.gz
  cd fades-X.Y
  git init
  git add .
  git commit -m "import fades_X.Y.orig.tar.gz"
  git checkout -b upstream
  pristine-tar commit ../fades_X.Y.orig.tar.gz upstream
  git-dpm init ../fades_X.Y.orig.tar.gz


Copy the project's debian dir and change changelog (be sure that this
"debian" dir is properly updated in the project... notably, be sure
copyright year is current one and also that no new dependencies were
introduced since last release).

  cp -pr $DEVEL/fades/pkg/debian .
  dch   # doing the following:
    - version should be   (X.Y-1) unstable
    - just leave one "* Initial release."


Continue with preparations:

  git add debian/*
  git commit -m "Added debian dir."
  git-dpm prepare
  git-dpm status


Build the .deb

  debuild -us -uc -I -i


To test the .deb you just created:

  sudo dpkg -i *.deb


If you want to uninstall it do:

    sudo dpkg -r fades


How to release it to Debian
---------------------------

Need just to report a bug very similar to this one:  https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=814913

For that, just run the following and answer the questions:

    reportbug -B debian

(I had to do that twice, not sure why: first time it asked some questions and then errored out, second time it picked up from there and finish the job)


How to release it to Arch
-------------------------

Edit ``pkg/archlinux/PKGBUILD`` and set *pkgver* and *md5sums*, then run
*makepkg -S* inside the same directory that PKGBUILD. It will generate a
file named 'fades-X.X-X.src.tar.gz'.

Finally submit this file at the AUR page.


How to release it to the Snap store
-----------------------------------

Edit the snapcraft yaml and change the "version" number

    vi pkg/snap/snapcraft.yaml

Build the snap:

    snapcraft

Push it to the store and release:

    snapcraft push fades_6.0_amd64.snap
    snapcraft release fades 9 stable


How to release to Mac/Brew
--------------------------

It should happen automatically.

Somebody/something just does it. The way to see if "it happened" is to check here:

    https://github.com/Homebrew/homebrew-core/pulls?utf8=%E2%9C%93&q=is%3Apr++fades


How to sign the files
---------------------

If you are putting files to download (notably, installators: .deb,
tarballs, etc) it's a good idea to sign them and offer checksums, in
case of somebody wanting to validate the files.

To sign it:

    gpg --armor --sign --detach-sig FILENAME

To create the checksum:

    sha1sum FILENAME > FILENAME.sha1


Work to do on GitHub
--------------------

Go to the fades releases page...

    https://github.com/PyAr/fades/releases/

...and create a new release, using the just generated tag above, title "Release X.Y", and pasting the changelog created for some steos above too.


Work to do on ReadTheDocs
-------------------------

Go to fades admin page, versions:

    https://readthedocs.org/dashboard/fades/versions/

There select the revision for the tag created above, and tick in the "Active" checkbox it has, and click on "Save" at the bottom of the page.

After some seconds, it should appear as "compiling" here:

    https://readthedocs.org/projects/fades/builds/

When that is done, go to the same versions page as before, and change the combobox at its top, selecting this last revision as the default one for when going to project's root. Don't forget to click Save, at the bottom.

Verify all is ok going to...

    http://fades.readthedocs.io/

(it should redirect to the latest just-released tag)


Final steps
-----------

- Remember to update the .deb and .tar.gz in www.taniquetil.com.ar/fades

- Create a change log and send press releases:
    - a tweet,
    - PyAr mail list, IRC and Telegram group
    - fades' Telegram group and mail list
    - python-announces
